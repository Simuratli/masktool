import React, { useEffect, useState } from 'react'
import { ProgressItem, ProgressSettings, ProgressDividedProgresbar } from './ProgressItem'
import { useSelector } from 'react-redux'
import { ReducerType } from '../../redux/reducers/reducer.types'

function Progress() {
  const stepState = useSelector((state: ReducerType) => state.stepReducer.step)
  const [disabledContainer, setdisabledContainer] = useState<string[]>([])




  useEffect(() => {
    setdisabledContainer((prev: string[]) => ([...prev, stepState]))
  }, [stepState])


  return (
    <div className='progress'>
      <ProgressItem
        disabled={!disabledContainer.includes('notifications')}
        id='notifications'
        icon={<span className='progress__item__icon'><svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.2464 0.5C15.1949 0.5 15.1438 0.504187 15.0934 0.508374C15.0656 0.501847 15.0368 0.499753 15.0083 0.502093H4.8632C4.00323 0.502093 3.30125 1.20184 3.30125 2.06196V12.0873C3.30137 12.114 3.30531 12.1404 3.31307 12.1659L1.27906 12.1481C1.20517 12.1473 1.13399 12.1761 1.08153 12.2282C1.02906 12.2802 0.999753 12.3511 1 12.425V14.8177C1 15.6777 1.69987 16.3776 2.55987 16.3776H12.4834C13.3433 16.3776 14.0453 15.6756 14.0453 14.8157V4.86788H16.6984C16.8335 4.86838 16.949 4.77109 16.9714 4.63796C16.9851 4.55471 17 4.45852 17 4.34916V2.25544C17 1.28894 16.2128 0.500378 15.2464 0.5ZM4.86323 1.05173H13.9743C13.6771 1.36651 13.4931 1.78978 13.4931 2.25543V11.3636C13.4895 11.384 13.4884 11.4045 13.4895 11.4251C13.4905 11.4534 13.4917 11.4784 13.4917 11.5006V14.4251C13.4917 15.2064 12.8699 15.826 12.0887 15.826C11.3074 15.826 10.6873 15.2064 10.6873 14.4251V12.5049C10.6872 12.4291 10.6559 12.3565 10.6009 12.3044C10.5457 12.2523 10.4715 12.2254 10.3958 12.2295C10.3864 12.2284 10.3771 12.2277 10.3677 12.2274L3.84034 12.1703C3.84883 12.1435 3.85327 12.1155 3.85327 12.0873V2.06197C3.85327 1.49804 4.2993 1.05173 4.86323 1.05173ZM15.247 1.05173C15.9174 1.05173 16.4485 1.58498 16.4485 2.25543V4.31627H14.0455V2.25543C14.0455 1.5851 14.5767 1.05173 15.247 1.05173ZM11.4672 4.118C11.457 4.11763 11.4469 4.11787 11.4367 4.11861H5.71828C5.70942 4.11812 5.70067 4.11812 5.69193 4.11861C5.54698 4.1345 5.43934 4.26036 5.44636 4.40605C5.45338 4.55174 5.57247 4.66677 5.71828 4.66874H11.4367C11.5111 4.67514 11.5848 4.65125 11.6414 4.60236C11.6978 4.55346 11.7319 4.48376 11.7361 4.40925C11.7403 4.33462 11.714 4.26159 11.6634 4.20666C11.6127 4.15186 11.5419 4.11984 11.4672 4.118ZM5.71856 6.60139C5.56844 6.6046 5.44848 6.72713 5.44848 6.87726C5.44848 7.02726 5.56844 7.14992 5.71856 7.15312H11.437C11.587 7.14992 11.707 7.02726 11.707 6.87726C11.707 6.72713 11.587 6.6046 11.437 6.60139H5.71856ZM5.71856 9.08577C5.6443 9.08404 5.57262 9.11237 5.51954 9.16434C5.46646 9.21631 5.43654 9.28737 5.43654 9.36163C5.43654 9.43589 5.46646 9.50695 5.51954 9.55892C5.57262 9.61077 5.6443 9.63909 5.71856 9.63749H11.437C11.587 9.63417 11.7068 9.51163 11.7068 9.36163C11.7068 9.21163 11.587 9.08909 11.437 9.08577H5.71856ZM1.55193 12.7023L10.1355 12.7777V14.4254C10.1355 14.9751 10.3646 15.4711 10.7308 15.8263L2.56026 15.8262C1.99633 15.8262 1.55212 15.3821 1.55212 14.818L1.55193 12.7023Z" fill="#FF8F3E" /></svg></span>}
        text="notifications"
      />
      <ProgressItem
        disabled={!disabledContainer.includes('tutorial')}
        id='tutorial'
        icon={<span className='progress__item__icon'><svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillRule="evenodd" clipRule="evenodd" d="M8.00685 10.8518C8.05651 11.2178 8.3703 11.5 8.75 11.5C9.16421 11.5 9.5 11.1642 9.5 10.75V6.69103L9.49315 6.58926C9.44349 6.22319 9.1297 5.94103 8.75 5.94103C8.33579 5.94103 8 6.27682 8 6.69103V10.75L8.00685 10.8518ZM8.63219 3.54509C8.21797 3.54509 7.88219 3.88087 7.88219 4.29509C7.88219 4.7093 8.21797 5.04509 8.63219 5.04509C9.0464 5.04509 9.38219 4.7093 9.38219 4.29509C9.38219 3.88087 9.0464 3.54509 8.63219 3.54509Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M16.75 8C16.75 3.58172 13.1683 0 8.75 0C4.33172 0 0.75 3.58172 0.75 8C0.75 12.4183 4.33172 16 8.75 16C13.1683 16 16.75 12.4183 16.75 8ZM2.25 8C2.25 4.41015 5.16015 1.5 8.75 1.5C12.3399 1.5 15.25 4.41015 15.25 8C15.25 11.5899 12.3399 14.5 8.75 14.5C5.16015 14.5 2.25 11.5899 2.25 8Z" fill="#E8EBFE" /></svg></span>}
        text="HOW TO USE IT"
      />
      <ProgressItem
        disabled={!disabledContainer.includes('rules')}
        id='rules'
        icon={<span className='progress__item__icon'><svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.0149 0.5C12.0856 0.49964 11.195 0.871483 10.5419 1.5325C9.97843 1.03298 9.2517 0.757134 8.49865 0.757134C7.74578 0.757134 7.01882 1.033 6.45541 1.5325C5.69263 0.76308 4.6151 0.392639 3.54047 0.530056C2.46565 0.66763 1.51613 1.29749 0.971762 2.23424C0.427256 3.17095 0.349628 4.30772 0.762161 5.30984C1.17452 6.31173 2.02966 7.0646 3.07585 7.34681C4.12186 7.6288 5.23973 7.40785 6.09996 6.74896C6.96014 6.09009 7.46468 5.06856 7.46487 3.98508V3.85867V3.85849C7.46487 3.48953 7.66168 3.14868 7.98111 2.96429C8.30056 2.7799 8.6942 2.7799 9.01361 2.96429C9.33305 3.14868 9.52986 3.48957 9.52986 3.85849V3.9849V3.98508C9.52806 5.16615 10.1253 6.26784 11.1165 6.91049C12.1076 7.55314 13.357 7.64911 14.4348 7.16547V12.8913C14.4348 13.1652 14.326 13.4277 14.1322 13.6215C13.9387 13.815 13.6759 13.9238 13.402 13.9238C13.1283 13.9238 12.8656 14.0326 12.672 14.2263C12.4783 14.4199 12.3695 14.6826 12.3695 14.9565C12.3695 15.2302 12.4783 15.4929 12.672 15.6865C12.8656 15.8803 13.1283 15.989 13.402 15.989C14.2237 15.989 15.0117 15.6627 15.5926 15.0816C16.1735 14.5007 16.5 13.7128 16.5 12.8912V4.11424V3.98513V3.98531C16.4986 3.06137 16.131 2.17579 15.4777 1.52249C14.8244 0.869193 13.9389 0.501655 13.0149 0.500226L13.0149 0.5ZM3.97978 5.4048C3.60325 5.4048 3.24203 5.25534 2.97591 4.98902C2.70959 4.7227 2.55995 4.36168 2.55995 3.98515C2.55995 3.60844 2.70959 3.2474 2.97591 2.9811C3.24205 2.71495 3.60325 2.56532 3.97978 2.56532C4.35631 2.56532 4.71753 2.71495 4.98365 2.9811C5.24997 3.24742 5.39961 3.60844 5.39961 3.98515C5.39889 4.3615 5.24907 4.72216 4.98292 4.98833C4.71678 5.25447 4.35609 5.40429 3.97975 5.40483L3.97978 5.4048ZM13.0149 5.4048C12.6384 5.4048 12.2772 5.25534 12.0111 4.98902C11.7447 4.7227 11.5951 4.36168 11.5951 3.98515C11.5951 3.60844 11.7447 3.2474 12.0111 2.9811C12.2772 2.71495 12.6384 2.56532 13.0149 2.56532C13.3915 2.56532 13.7527 2.71495 14.0188 2.9811C14.2851 3.24742 14.4348 3.60844 14.4348 3.98515C14.434 4.3615 14.2842 4.72216 14.0181 4.98833C13.7519 5.25447 13.3912 5.40429 13.0149 5.40483L13.0149 5.4048Z" fill="#E8EBFE" stroke="white" strokeWidth="0.5" /><path d="M8.41754 10.8259L8.49749 10.72L8.57744 10.8259C8.88536 11.2521 9.2979 11.5917 9.77524 11.812C10.701 12.2229 11.7724 12.1314 12.615 11.5694C12.8026 11.4441 12.9052 11.2251 12.8815 11.0006C12.8577 10.7762 12.7111 10.5837 12.5013 10.5007C12.0632 10.3163 11.6811 10.0197 11.3939 9.64106L10.8595 9.0292C10.2436 8.38222 9.38936 8.01611 8.49622 8.01611C7.60289 8.01611 6.74884 8.38219 6.13279 9.0292L5.59833 9.64106H5.59851C5.31112 10.0197 4.92917 10.3163 4.49111 10.5007C4.27592 10.5796 4.12376 10.7731 4.09747 11.0008C4.07136 11.2284 4.17562 11.4513 4.36704 11.5772C5.20957 12.1391 6.28115 12.2306 7.20675 11.8197C7.68986 11.5993 8.10709 11.2568 8.41756 10.8259H8.41754Z" fill="#E8EBFE" strokeWidth="0.5" /></svg></span>}
        text="choose masking rules"
      />
      {
        stepState === "progress" ?
          <ProgressDividedProgresbar />
          :
          <ProgressItem
            disabled={true}
            id='progress'
            icon={<span className='progress__item__icon'><svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fillRule="evenodd" clipRule="evenodd" d="M8.05127 3.38674V5.09117C8.05127 5.43079 8.32715 5.70666 8.66691 5.70666C9.00667 5.70666 9.2824 5.43079 9.2824 5.09117V3.38674C9.2824 3.04698 9.00667 2.77124 8.66691 2.77124C8.32715 2.77124 8.05127 3.04698 8.05127 3.38674Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M11.8473 4.44901L10.642 5.65433C10.4019 5.89448 10.4019 6.28453 10.6421 6.52482C10.8824 6.76497 11.2725 6.76511 11.5126 6.52482L12.7178 5.31964C12.9581 5.07949 12.958 4.6893 12.7178 4.44916C12.4775 4.20887 12.0875 4.20887 11.8473 4.44902L11.8473 4.44901Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M13.4963 7.88452H12.0758C11.736 7.88452 11.4604 8.1604 11.4604 8.50016C11.4604 8.83992 11.736 9.11565 12.0758 9.11565H13.4963C13.836 9.11565 14.1116 8.83992 14.1116 8.50016C14.1116 8.1604 13.836 7.88452 13.4963 7.88452Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M12.517 11.4793L11.5125 10.475C11.2724 10.2347 10.8823 10.2348 10.6422 10.475C10.4019 10.7153 10.4018 11.1053 10.6421 11.3455L11.6464 12.3499C11.8867 12.5901 12.2766 12.5899 12.5169 12.3498C12.7572 12.1095 12.7573 11.7196 12.517 11.4793V11.4793Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M9.2824 13.0452V11.9088C9.2824 11.5691 9.00653 11.2933 8.66677 11.2933C8.327 11.2933 8.05127 11.5691 8.05127 11.9088V13.0452C8.05127 13.3849 8.327 13.6607 8.66677 13.6607C9.00653 13.6607 9.2824 13.3849 9.2824 13.0452Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M5.88813 12.149L6.69158 11.3456C6.93187 11.1053 6.93187 10.7153 6.69158 10.475C6.45129 10.2348 6.06124 10.2347 5.82109 10.475L5.0175 11.2784C4.77735 11.5187 4.77735 11.9088 5.01764 12.149C5.25779 12.3892 5.64783 12.3893 5.88812 12.149H5.88813Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M4.40602 9.11553H5.25822C5.59784 9.11553 5.87372 8.83966 5.87372 8.4999C5.87372 8.16013 5.59784 7.8844 5.25822 7.8844H4.40602C4.06626 7.8844 3.79053 8.16013 3.79053 8.4999C3.79053 8.83966 4.06626 9.11553 4.40602 9.11553Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M5.21818 5.92199L5.82091 6.52472C6.06106 6.76487 6.45111 6.76487 6.6914 6.52458C6.93155 6.28429 6.93169 5.89424 6.6914 5.65409L6.08881 5.0515C5.84866 4.81121 5.45861 4.81135 5.21832 5.0515C4.97803 5.29179 4.97803 5.68184 5.21818 5.92199L5.21818 5.92199Z" fill="#E8EBFE" /><path fillRule="evenodd" clipRule="evenodd" d="M13.4544 13.2871C10.8121 15.9292 6.52176 15.9292 3.87969 13.2871C1.23746 10.645 1.23746 6.35454 3.87969 3.71248C6.52179 1.07038 10.8123 1.07038 13.4544 3.71248C15.5372 5.79529 15.9785 8.90234 14.7775 11.4188C14.6309 11.7256 14.7613 12.093 15.0676 12.2396C15.3742 12.3858 15.7421 12.2554 15.8883 11.9489C17.3074 8.97513 16.7864 5.30329 14.325 2.84201C11.2023 -0.280669 6.1315 -0.280669 3.009 2.84201C-0.113677 5.96468 -0.113677 11.0351 3.009 14.158C6.13154 17.2807 11.2021 17.2807 14.325 14.158C14.5651 13.9177 14.5651 13.5277 14.325 13.2874C14.0847 13.0471 13.6945 13.0471 13.4544 13.2874L13.4544 13.2871Z" fill="#E8EBFE" /></svg></span>}
            text="masking progress"
          />
      }

      <ProgressSettings stepState={stepState} />

    </div>
  )
}

export default React.memo(Progress)